<ng-container *ngIf="data$ | async as event; else loading">
  <h1 class="mat-display-3">{{ event.title }}</h1>
  <h4 class="">{{ event.date | toLocalDateString }} {{ event.date | toLocalTimeString }}</h4>
  <main>
    <app-markdown-viewer [markdownText]="event.description"></app-markdown-viewer>
    <mat-chip-list>
      <mat-chip *ngFor="let tag of event.tags" (click)="onTagClick(tag)"> {{ tag }} </mat-chip>
    </mat-chip-list>
    <mat-list *ngIf="event.participants.length > 0">
      <mat-divider></mat-divider>
      <div mat-subheader>
        RÃ¼ckmeldungen: Deadline {{ event.deadline | toLocalDateString }} {{ event.deadline | toLocalTimeString }}
      </div>
      <mat-list-item>
        <div mat-line>Angenommen: {{ amountAccumulated$ | async }} Personen</div>
        <mat-chip-list mat-line>
          <ng-container *ngFor="let participant of event.participants">
            <mat-chip [color]="'primary'" selected *ngIf="participant.amount > 0">
              {{ participant.name + ' ' + participant.amount }}
            </mat-chip>
          </ng-container>
        </mat-chip-list>
      </mat-list-item>
      <mat-list-item>
        <div mat-line>Abgelehnt:</div>
        <mat-chip-list mat-line>
          <ng-container *ngFor="let participant of event.participants">
            <mat-chip [color]="'warn'" selected *ngIf="participant.amount === 0">
              {{ participant.name }}
            </mat-chip>
          </ng-container>
        </mat-chip-list>
      </mat-list-item>
      <mat-list-item>
        <div mat-line>Ausstehend: {{ pendingPercent$ | async }}% / {{ pendingAmount$ | async }} Personen</div>
        <mat-chip-list mat-line>
          <ng-container *ngFor="let participant of event.participants">
            <mat-chip *ngIf="participant.amount < 0">
              {{ participant.name }}
            </mat-chip>
          </ng-container>
        </mat-chip-list>
      </mat-list-item>
    </mat-list>
    <div class="fab-container">
      <a mat-fab [color]="'primary'" [routerLink]="'/events/edit/' + event.id"><mat-icon>edit</mat-icon></a>
      <a mat-fab [color]="'primary'" [routerLink]="'/auth/my-events'"><mat-icon>reply</mat-icon></a>
    </div>
  </main>

  <mat-toolbar class="footer">
    <div class="spacer"></div>
    <div>{{ event.ownerName }}</div>
  </mat-toolbar>
</ng-container>

<ng-template #loading>
  <mat-progress-spinner mode="indeterminate" color="accent"></mat-progress-spinner>
</ng-template>
